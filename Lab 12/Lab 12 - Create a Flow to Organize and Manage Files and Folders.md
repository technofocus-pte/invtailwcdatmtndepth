**ラボ１２－ファイルとフォルダを整理および管理するためのフローを作成する**

**目標:**このラボの目的は、**Power Automate
Desktop**を使用して、デスクトップ上の指定フォルダーからファイルをバックアップするプロセスを自動化することです。参加者は、
**Contoso_Files**というフォルダーからファイルをコピーし、新しく作成したバックアップフォルダーに移動し、バックアップファイルにタイムスタンプを追加するフローを作成します。このラボでは、フォルダーの作成、ファイルのコピー、動的な日付と時刻の形式での名前変更など、ファイル管理タスクの自動化に関する実践的な経験を積むことができます。

**所要時間：** 20分

**タスク１：フォルダーとデスクトップフローを作成する**

1.  デスクトップにフォルダーを作成し、名前を**Contoso_Files**に変更します**。**

> ![](./media/image1.png)

2.  **C:\***フォルダーから**Report.txt**ファイルを選択し、.**txt**ファイルを**Contoso_Files**フォルダーに移動します。

> ![](./media/image2.png)

3.  Power Automateデスクトップを開き、 **Office 365 tenant
    credential**で**Login**します。上部のバーから環境として**Contoso**を選択します。

> ![](./media/image3.png)

4.  左上隅の**+ New
    flow**をクリックして、新しいフローの作成を開始します。

> ![](./media/image4.png)

5.  フロー名に+++ **Backup File Flow +++**と入力し、**Power Fx enable
    (Preview)**のチェックボックスをオンにします。**Create**をクリックします。

> ![](./media/image5.png)

6.  左側の**Actions**ナビゲーションバーから、+++**Get special
    folder**+++アクションをワークスペースで検索します。このアクションをダブルクリックして選択し、フローに追加します。

> ![](./media/image6.png)

7.  次に、**Save**ボタンをクリックして、ボタンのデフォルト設定を保存します。

> ![](./media/image7.png)

8.  左側の**Actions**ナビゲーションバーから、+++**Get files in
    folder**+++アクションをワークスペースで検索します。アクションをダブルクリックして選択し、フローに追加します。

> ![](./media/image8.png)

9.  **Get files in
    folder**アクションを追加し、フォルダーフィールド+++\*\*C:\_Files**+++**
    に設定します。この設定により、前デスクトップに作成したフォルダーが選択されます。**Save**ボタンをクリックします。

> ![](./media/image9.png)

10. 左側の**Actions**ナビゲーションバーで、+++**Create
    Folder**+++アクションをワークスペースに検索します。アクションをダブルクリックして選択し、フローに追加します。

> ![](./media/image10.png)

11. フォルダーの作成アクションの**Create new folder
    into**フィールドに**+++\*\*C:\*+++**と入力します。**New folder
    name**フィールドに**Contoso_Backup**と入力します。情報を入力したら、**Save**ボタンをクリックします。

> ![](./media/image11.png)

12. 左側の**Actions**ナビゲーションバーで、+++**Copy
    file(s)**+++アクションをワークスペースに検索します。アクションをダブルクリックして選択し、フローに追加します。

> ![](./media/image12.png)

13. **File(s) to Copy**フィールドを**+++ =Files +++**に、**Destination
    Folder**フィールドを+++\*\*C:\_Backup**+++**に、と**+++If File(s)
    Exists+++**ドロップダウンオプションを**Overwriteに設定します**。設定が完了したら、**Save\*\***ボタンをクリックします。

> ![](./media/image13.png)

14. 左側の**Actions**ナビゲーションバーから、+++**Rename
    file(s)**+++アクションをワークスペースで検索します。アクションをダブルクリックして選択し、フローに追加します。

> ![](./media/image14.png)

15. **File(s) to
    rename**フィールドをto +++\*\*C:\_Backup.txt**+++**に設定します。**Rename
    scheme**ドロップダウンメニューで、**Add
    datetime**オプションを選択します。**Separator**ドロップダウンオプションを**Nothing**に設定し、**DateTime
    Format**オプションを**+++ dd.MM.yy_HH.mm**
    +++に設定します。セットアップが完了したら、**Save**ボタンをクリックします。

> ![](./media/image15.png)

16. **完了した**フローは次のスクリーンショットのようになります。

> ![](./media/image16.png)

**タスク2: フローをテストする**

1.  実行フローが完了すると、デスクトップにBackup
    Filesという新しいフォルダが作成されます。このフォルダには、Importantと名前のフォルダのすべての内容と、Backup
    Logというテキストファイルが含まれます。このファイルのファイル名には、フローが最後に実行された最後日時が付加されます。

> ![](./media/image17.png)
>
> ![](./media/image18.png)

**結論：**

このラボでは、参加者はPower Automate
Desktopフローを作成し、ファイルとフォルダーの整理と管理を自動化しました。Contoso_Filesという指定フォルダーから新しく作成したバックアップフォルダーにファイルをバックアップすることで、フォルダーの作成、ファイルのコピー、タイムスタンプによる動的なファイル名変更など、基本的なファイル管理タスクを実際に体験しました。このラボでは、Power
Automate
Desktopがファイル整理プロセスの効率化、手作業の削減、重要なファイルの安全なバックアップを実現する上で効果的である点を詳しく説明します。参加者は、自動化を活用して効率的なファイル管理を行い、日常業務の生産性を向上させる方法について実践的な知識を習得しました。
